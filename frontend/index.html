<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="Cur8 Game Platform - Play amazing browser games and earn rewards">

    <!-- Performance Optimization -->
    <link rel="dns-prefetch" href="//localhost:8000">
    <link rel="preconnect" href="http://localhost:8000">
    <link rel="preconnect" href="http://localhost:8000" crossorigin>

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#667eea">
    <link rel="manifest" href="/manifest.json">

    <!-- iOS Web App Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Cur8 Games">
    <meta name="mobile-web-app-capable" content="yes">

    <!-- iOS Icons -->
    <link rel="apple-touch-icon" href="/icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-180x180.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-192x192.png">

    <title>Cur8 Games</title>
    <!-- CSS Modular Structure -->
    <link rel="stylesheet" href="./css/variables.css">
    <link rel="stylesheet" href="./css/layout.css">
    <link rel="stylesheet" href="./css/navigation.css">
    <link rel="stylesheet" href="./css/game-catalog.css">
    <link rel="stylesheet" href="./css/game-player.css">
    <link rel="stylesheet" href="./css/leaderboard.css">
    <link rel="stylesheet" href="./css/profile.css">
    <link rel="stylesheet" href="./css/wallet.css">
    <link rel="stylesheet" href="./css/wallet-stats.css">
    <link rel="stylesheet" href="./css/utilities.css">
    <link rel="stylesheet" href="./css/quest-hero.css">
    <link rel="stylesheet" href="./css/auth.css">
    <link rel="stylesheet" href="./css/daily-login-banner.css">
</head>

<body>
    <!-- Daily Login Banner (will be shown after login) -->
    <div id="daily-login-overlay" class="daily-login-overlay" onclick="dailyLoginBanner.hide()"></div>
    
    <!-- Floating button to open daily reward banner (shown only when can claim) -->
    <button id="daily-login-trigger" class="daily-login-trigger" onclick="dailyLoginBanner.show()" style="display:none;" title="Open Daily Rewards">
        üéÅ
    </button>
    
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <!--mettiamo il logo qui , C:\progetti\Ggameplatform\icon-72x72.png-->
                <div class="logo-container">
                    <img src="./icons/icon-72x72.png" alt="Cur8 Games Logo" width="72" height="72">
                    <h1>Cur8 Games</h1>
                </div>

            </div>
            <div class="nav-menu" id="navMenu">

                <div class="nav-links">
                    <a href="#/" class="nav-link active" data-route="/">Games</a>
                    <a href="#/leaderboard" class="nav-link" data-route="/leaderboard">üèÜ Leaderboard</a>
                    <a href="#/quests" class="nav-link auth-required" data-route="/quests" id="questsLink">üéØ Quests</a>
                    <a href="#/wallet" class="nav-link auth-required" data-route="/wallet" id="walletLink">ü™ô Wallet</a>
                    <a href="#/about" class="nav-link" data-route="/about">About</a>
                    <a href="#/profile" class="nav-link auth-required" data-route="/profile" id="profileLink">üë§ Profile</a>
                </div>
            <!-- Multiplier card placed before level/profile for requested order -->
            <div id="multiplierCard" class="nav-multiplier-card" style="display:flex;align-items:center;margin-left:8px;gap:6px;cursor:pointer;">
                <div class="multiplier-title" style="display:flex;flex-direction:column;line-height:1;text-transform:uppercase;">
                    <span style="font-size:12px;">CUR8 XP</span>
                    <span style="font-weight:700;">MULTIPLIER</span>
                </div>
                <div class="multiplier-value" id="navMultiplier">1.00x</div>
            </div>
            <div id="levelCardContainer" class="nav-level-card" style="display:flex; align-items:center; margin-left:8px; gap:8px;">
                <div id="levelBadgeContainer"></div>
            </div>
            <!-- Minimal `userInfo` placeholder (hidden via CSS) - required by JS to populate level badge and auth links -->
            <div id="userInfo" class="user-info">
                <div class="nav-user-card">
                    <div class="nav-user-meta">
                        <span id="userName" class="nav-username" style="font-weight:700;color:var(--text-primary);"></span>
                    </div>
                </div>
            </div>
            <!-- Logout moved out of the profile card to be the last visible control in the navbar -->
            <div class="nav-logout" style="margin-left:8px; display:flex; flex-direction:column; align-items:center; gap:4px;">
                <span id="navUserNameTop" class="nav-username-top" style="font-size:0.85rem; color:rgba(255,255,255,0.9); font-weight:600;"></span>
                <button id="logoutBtn" class="btn-logout">Logout</button>
            </div>
            </div>
            <button class="nav-toggle" id="navToggle" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main id="app" class="container">
        <!-- Content will be dynamically loaded here -->
        <div class="loading">Loading...</div>
    </main>



    <!-- Templates -->

    <!-- Game Catalog Template -->
    <template id="catalog-template">
        <div class="catalog">
            <div id="game-grid" class="game-grid">
                <!-- Game cards will be inserted here -->
            </div>
        </div>
    </template>

    <!-- Game Card Template -->
    <template id="game-card-template">
        <div class="game-card" data-game-id="">
            <div class="game-thumbnail">
                <img src="" alt="" loading="lazy">
                <div class="game-overlay">
                    <button class="play-btn">Play Now</button>
                </div>
            </div>
            <div class="game-info">
                <h3 class="game-title"></h3>
                <p class="game-description"></p>
                <div class="game-meta">
                    <span class="game-author"></span>
                    <span class="game-category"></span>
                </div>
                <div class="game-tags"></div>
            </div>
        </div>
    </template>

    <!-- Game Detail Template -->
    <template id="detail-template">
        <div class="game-detail">
            <button class="back-btn">‚Üê Back to Catalog</button>
            <div class="detail-content">
                <div class="detail-header">
                    <img class="detail-thumbnail" src="" alt="">
                    <div class="detail-info">
                        <h2 class="detail-title"></h2>
                        <p class="detail-author"></p>
                        <p class="detail-version"></p>
                        <div class="detail-meta">
                            <span class="detail-category"></span>
                            <span class="detail-rating"></span>
                        </div>
                        <div class="detail-tags"></div>
                    </div>
                </div>
                <div class="detail-description"></div>
                <button class="play-game-btn">Play Game</button>
                <div class="detail-stats">
                    <div class="stat">
                        <span class="stat-label">Play Count</span>
                        <span class="stat-value"></span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">Players</span>
                        <span class="stat-value"></span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">Difficulty</span>
                        <span class="stat-value"></span>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Game Player Template -->
    <template id="player-template">
        <div class="game-player">

            <div class="player-container">
                <iframe id="game-iframe"
                    sandbox="allow-scripts allow-same-origin allow-pointer-lock allow-forms allow-popups"
                    allow="gamepad; fullscreen; xr-spatial-tracking; autoplay" allowfullscreen
                    referrerpolicy="strict-origin-when-cross-origin"
                    style="will-change: transform; border: 0;"></iframe>
            </div>
        </div>
    </template>

    <!-- About Template -->
    <template id="about-template">
        <div class="about">
            <div class="about-header">
                <h2>üéÆ Cur8 Game Platform</h2>
                <p class="subtitle">A complete platform to play, compete, and earn real rewards while enjoying your favorite browser games.</p>
            </div>
            
            <div class="version-box">
                <div class="version-label">Current Version</div>
                <div id="app-version" class="version-number">Loading...</div>
                <div id="app-build-info" class="version-meta"></div>
            </div>
            
            <div class="about-section">
                <h3>Key Features</h3>
                <div class="feature-grid">
                    <div class="feature-item">
                        <div class="feature-icon">üéÆ</div>
                        <div class="feature-content">
                            <div class="feature-title">Game Catalog</div>
                            <div class="feature-desc">Wide collection of HTML5 games with filters and search</div>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üèÜ</div>
                        <div class="feature-content">
                            <div class="feature-title">Weekly Leaderboards</div>
                            <div class="feature-desc">Compete with other players to win STEEM and Coins</div>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üìä</div>
                        <div class="feature-content">
                            <div class="feature-title">XP & Level System</div>
                            <div class="feature-desc">Earn experience and reach new levels (up to 100)</div>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üéØ</div>
                        <div class="feature-content">
                            <div class="feature-title">Quest System</div>
                            <div class="feature-desc">Complete daily and weekly challenges for extra rewards</div>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">ü™ô</div>
                        <div class="feature-content">
                            <div class="feature-title">In-Game Economy</div>
                            <div class="feature-desc">Earn and spend coins on the platform</div>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üíé</div>
                        <div class="feature-content">
                            <div class="feature-title">STEEM Rewards</div>
                            <div class="feature-desc">Win STEEM cryptocurrency in weekly leaderboards</div>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üë§</div>
                        <div class="feature-content">
                            <div class="feature-title">Integrated Profile</div>
                            <div class="feature-desc">Statistics, progress, and Steem blockchain connection</div>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üì±</div>
                        <div class="feature-content">
                            <div class="feature-title">Mobile-First PWA</div>
                            <div class="feature-desc">Installable as an app, works offline</div>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üîí</div>
                        <div class="feature-content">
                            <div class="feature-title">Secure Sandboxing</div>
                            <div class="feature-desc">Games isolated in iframes for maximum security</div>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üîÑ</div>
                        <div class="feature-content">
                            <div class="feature-title">Auto-Update</div>
                            <div class="feature-desc">Automatic notifications for new versions</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="about-section">
                <h3>Reward System</h3>
                <ul class="reward-list">
                    <li class="reward-item">
                        <strong>XP Rewards</strong> - Each game earns you XP based on performance
                    </li>
                    <li class="reward-item">
                        <strong>Level Milestones</strong> - Bonus Coins at levels 5, 10, 15, 20, 25, 30, 40, 50, 75, 100
                    </li>
                    <li class="reward-item">
                        <strong>Quest Rewards</strong> - Complete objectives for XP and Coins
                    </li>
                    <li class="reward-item">
                        <strong>Weekly Leaderboards</strong> - Top 10 win STEEM + Coins (1st place: 10 STEEM + 5000 Coins)
                    </li>
                </ul>
            </div>
        </div>
    </template>

    <!-- Quests Template -->
    <template id="quests-template">
        <div class="quests">
            <!-- Hero Section with Parallax -->
            <div class="quests-hero" id="questsHero">
                <div class="hero-background">
                    <div class="hero-gradient"></div>
                </div>
                <div class="hero-content">
                    <div class="hero-badge">QUEST SYSTEM</div>
                    <h1 class="hero-title">
                        <span class="hero-title-main">Your Epic Journey</span>
                        <span class="hero-title-sub">Awaits</span>
                    </h1>
                    <p class="hero-description">Complete challenges, earn rewards, and become a legend</p>
                    <div class="hero-stats">
                        <div class="hero-stat">
                            <div class="hero-stat-value" id="heroActiveCount">0</div>
                            <div class="hero-stat-label">Active</div>
                        </div>
                        <div class="hero-stat hero-stat-highlight">
                            <div class="hero-stat-value" id="heroReadyCount">0</div>
                            <div class="hero-stat-label">Ready</div>
                        </div>
                        <div class="hero-stat">
                            <div class="hero-stat-value" id="heroClaimedCount">0</div>
                            <div class="hero-stat-label">Claimed</div>
                        </div>
                        <div class="hero-stat hero-stat-xp">
                            <div class="hero-stat-value" id="heroTotalXP">0</div>
                            <div class="hero-stat-label">Total XP</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="quest-filters">
                <button class="quest-filter-btn active" data-filter="platform">
                    <span class="filter-icon">üèÜ</span>
                    <span class="filter-text">Platform Quests</span>
                </button>
                <button class="quest-filter-btn" data-filter="games">
                    <span class="filter-icon">üéÆ</span>
                    <span class="filter-text">Games Quests</span>
                </button>
                <button class="quest-filter-btn" data-filter="ready">
                    <span class="filter-icon">üéÅ</span>
                    <span class="filter-text">Claimable</span>
                </button>
                <button class="quest-filter-btn" data-filter="claimed">
                    <span class="filter-icon">‚úÖ</span>
                    <span class="filter-text">Claimed</span>
                </button>
            </div>
            <div class="quests-list" id="questsList">
                <div class="loading">Loading quests...</div>
            </div>
            
            <!-- Scroll to top button -->
            <button class="scroll-to-top" id="scrollToTopQuests" aria-label="Scroll to top">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M18 15l-6-6-6 6"/>
                </svg>
            </button>
        </div>
    </template>

    <!-- Profile Template -->
    <template id="profile-template">
        <div class="profile">
            <div class="profile-header">
                <div class="profile-avatar">
                    <div class="avatar-circle">
                        <span class="avatar-icon"></span>
                    </div>
                </div>
                <div class="profile-info">
                    <h2 class="profile-username"></h2>
                    <p class="profile-type"></p>
                    <div class="profile-stats-quick">
                        <div class="stat-badge" id="multiplierQuickBadge">
                            <span class="stat-label">CUR8 Multiplier</span>
                            <span class="stat-value multiplier" id="multiplierValueHeader">1.00x</span>
                        </div>
                        <div class="stat-badge" id="coinsQuickBadge">
                            <span class="stat-label">ü™ô Coins</span>
                            <span class="stat-value" id="coinBalanceHeader">--</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="profile-content">
                <!-- Steem Post Button -->
                <div class="steem-post-banner" id="steemPostBanner" style="display: none;">
                    <div class="banner-content">
                        <div class="banner-icon">
                            <img src="./icons/steem.png" alt="Steem Logo">
                        </div>
                        <div class="banner-text">
                            <h3>Share Your Gaming Journey on Steem!</h3>
                            <p>Showcase your achievements, get upvoted by the Cur8 community, and turn your achievements into real rewards!</p>
                        </div>
                        <button id="shareOnSteemBtn" class="btn-share-steem">
                            <span class="btn-icon">üöÄ</span>
                            <span class="btn-text">Share on Steem</span>
                            <span class="btn-cost">500 ü™ô</span>
                        </button>
                    </div>
                </div>

                <h3>üìä Game Statistics</h3>
                <div class="stats-grid">
                    <div class="stats-left">
                        <div class="stat-card">
                            <div class="stat-icon">üéÆ</div>
                            <div class="stat-info">
                                <span class="stat-number" id="gamesPlayed" data-stat="games-played">0</span>
                                <span class="stat-text">Total Games</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üéØ</div>
                            <div class="stat-info">
                                <span class="stat-number" id="questsDone" data-stat="quests-done">0</span>
                                <span class="stat-text">Quests Done</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üïπÔ∏è</div>
                            <div class="stat-info">
                                <span class="stat-number" id="gamesTried" data-stat="games-tried">0</span>
                                <span class="stat-text">Games Tried</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üìÖ</div>
                            <div class="stat-info">
                                <span class="stat-number" id="daysMember" data-stat="days-member">0</span>
                                <span class="stat-text">Days Member</span>
                            </div>
                        </div>
                    </div>
                    <div class="stats-right">
                        <div class="level-card-container" id="levelCardContainer">
                            <!-- Level card will be inserted here by JavaScript -->
                        </div>
                    </div>
                </div>

                <h3>üèÜ High Scores by Game</h3>
                <div class="high-scores-list" id="highScoresList">
                    <div id="highScoresContainer">
                        <p class="text-muted">No high scores yet. Start playing to set records!</p>
                    </div>
                </div>

                <h3>üéØ Recent Activity</h3>
                <div class="activity-list" id="recentActivity">
                    <div id="recentActivityContainer">
                        <p class="text-muted">No recent activity</p>
                    </div>
                </div>

                <h3>‚öôÔ∏è Account Settings</h3>
                <div class="settings-section">
                    <div class="setting-item">
                        <div class="setting-info">
                            <strong>User ID</strong>
                            <span class="setting-value" id="userId"></span>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <strong>Account Type</strong>
                            <span class="setting-value" id="accountType"></span>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <strong>Member Since</strong>
                            <span class="setting-value" id="memberSince"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Login/Register Modal -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Welcome to Game Platform</h2>

            <div class="auth-tabs">
                <button class="tab-btn active" data-tab="steem">Steem Keychain</button>
                <button class="tab-btn" data-tab="anonymous">Play Anonymous</button>
            </div>

            <!-- Steem Keychain Tab -->
            <div id="steem-tab" class="tab-content active">
                <div class="auth-info">
                    <p>üîê Login with Steem Keychain for enhanced rewards!</p>
                    <ul class="benefits-list">
                        <li>‚úÖ Custom CUR8 multipliers</li>
                        <li>‚úÖ Track your progress and scores</li>
                        <li>‚úÖ Compete in leaderboards</li>
                        <li>‚úÖ Earn more CUR8 tokens</li>
                    </ul>
                </div>

                <div class="form-group">
                    <label>Steem Username</label>
                    <input type="text" id="steemUsername" placeholder="Enter your @username">
                </div>

                <div class="form-group">
                    <label>CUR8 Multiplier (1.0 - 5.0)</label>
                    <input type="number" id="steemMultiplier" value="1.5" min="1.0" max="5.0" step="0.1">
                    <small>Higher multipliers = more XP per game!</small>
                </div>

                <button id="keychainLoginBtn" class="btn-primary">
                    üîë Login with Keychain
                </button>

                <div id="keychainStatus" class="status-message"></div>
            </div>

            <!-- Anonymous Tab -->
            <div id="anonymous-tab" class="tab-content">
                <div class="auth-info">
                    <p>üë§ Play as a guest without registration</p>
                    <ul class="benefits-list">
                        <li>‚ö†Ô∏è No CUR8 multipliers (1.0x only)</li>
                        <li>‚ö†Ô∏è Progress not saved permanently</li>
                        <li>‚úÖ Instant play, no account needed</li>
                        <li>‚úÖ Still earn basic CUR8</li>
                    </ul>
                </div>

                <button id="anonymousBtn" class="btn-secondary">
                    üéÆ Play as Anonymous
                </button>

                <div id="anonymousStatus" class="status-message"></div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <!-- Load environment config first -->
    <script src="/env.js"></script>
    <script src="./js/nav.js"></script>
    <script src="./js/auth.js"></script>
    <script src="./js/coinAPI.js"></script>
    <script src="./js/CoinBalanceWidget.js"></script>
    <script src="./js/InfiniteScrollManager.js"></script>
    <script src="./js/WalletStatsRenderer.js"></script>
    <script src="./js/WalletRenderer.js"></script>
    <script src="./js/WalletProfileWidget.js"></script>
    <script src="./js/LeaderboardAPI.js"></script>
    <script src="./js/daily-login-banner.js"></script>
    <script src="./js/SteemPostAPI.js"></script>
    <script src="./js/SteemPostModal.js"></script>
    <link rel="stylesheet" href="./css/steem-post-modal.css">
    <script type="module" src="./js/main.js"></script>
    <script src="./js/nav-multiplier.js"></script>

    <!-- Initialize Coin Balance Widget and Daily Login Banner on login -->
    <script>
        // Function to initialize daily login banner
        function initDailyLoginBanner(user) {
            if (window.dailyLoginBanner && user && user.user_id) {
                window.dailyLoginBanner.init(user).then(() => {
                    // Don't auto-show banner, only show trigger button if can claim
                    console.log('Daily login banner initialized - trigger button managed automatically');
                }).catch(err => console.error('Failed to init daily login banner:', err));
            }
        }
        
        // Initialize coin widget and daily login banner when user logs in
        if (window.AuthManager) {
            const originalLogin = window.AuthManager.login;
            window.AuthManager.login = function (...args) {
                const result = originalLogin.apply(this, args);
                if (result && window.AuthManager.isLoggedIn()) {
                    // Initialize coin widget
                    const user = window.AuthManager.getUser();
                    if (user && user.user_id) {
                        if (!window.coinBalanceWidget) {
                            window.coinAPI = new window.CoinAPI();
                            window.coinBalanceWidget = new window.CoinBalanceWidget(window.coinAPI);
                        }
                        
                        // Initialize daily login banner
                        initDailyLoginBanner(user);
                    }
                }
                return result;
            };
        }
        
        // Also initialize when page loads if user is already logged in
        window.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                if (window.AuthManager && window.AuthManager.isLoggedIn()) {
                    const user = window.AuthManager.getUser();
                    if (user && user.user_id) {
                        console.log('User already logged in, initializing daily login banner...');
                        initDailyLoginBanner(user);
                    }
                }
            }, 1000); // Wait for AuthManager to be ready
        });
    </script>

    <!-- PWA Service Worker - Solo per fullscreen iOS -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js');
        }

        // PWA Install Prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            showInstallButton();
        });

        function showInstallButton() {
            const installBtn = document.createElement('button');
            installBtn.className = 'pwa-install-btn';
            installBtn.innerHTML = 'üì± Install App';
            installBtn.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border: none;
                padding: 12px 24px;
                border-radius: 24px;
                font-size: 14px;
                font-weight: 600;
                cursor: pointer;
                box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
                z-index: 9999;
                transition: transform 0.2s, box-shadow 0.2s;
            `;

            installBtn.addEventListener('mouseover', () => {
                installBtn.style.transform = 'translateY(-2px)';
                installBtn.style.boxShadow = '0 6px 16px rgba(102, 126, 234, 0.5)';
            });

            installBtn.addEventListener('mouseout', () => {
                installBtn.style.transform = 'translateY(0)';
                installBtn.style.boxShadow = '0 4px 12px rgba(102, 126, 234, 0.4)';
            });

            installBtn.addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    console.log(`PWA install outcome: ${outcome}`);
                    deferredPrompt = null;
                    installBtn.remove();
                }
            });

            document.body.appendChild(installBtn);

            // Auto-hide after 10 seconds
            setTimeout(() => {
                installBtn.style.opacity = '0';
                setTimeout(() => installBtn.remove(), 300);
            }, 10000);
        }

        // Track install event
        window.addEventListener('appinstalled', () => {
            console.log('‚úÖ PWA installed successfully');
            deferredPrompt = null;
        });

        // Add slideDown animation
        if (!document.getElementById('pwa-install-style')) {
            const style = document.createElement('style');
            style.id = 'pwa-install-style';
            style.textContent = `
            @keyframes slideDown {
                from {
                    transform: translate(-50%, -100%);
                    opacity: 0;
                }
                to {
                    transform: translate(-50%, 0);
                    opacity: 1;
                }
            }
            
            .update-content {
                display: flex;
                align-items: center;
                gap: 1rem;
            }
            
            .update-content p {
                margin: 0;
                font-weight: 600;
            }
            
            .btn-update, .btn-dismiss {
                padding: 0.5rem 1rem;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-weight: 600;
                transition: opacity 0.2s;
            }
            
            .btn-update {
                background: white;
                color: #667eea;
            }
            
            .btn-dismiss {
                background: rgba(255,255,255,0.2);
                color: white;
            }
            
            .btn-update:hover, .btn-dismiss:hover {
                opacity: 0.9;
            }
        `;
            document.head.appendChild(style);
        }
    </script>
</body>

</html>
